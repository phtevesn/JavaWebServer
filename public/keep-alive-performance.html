<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Why Keep-Alive Improves Performance</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #667eea; border-bottom: 3px solid #667eea; padding-bottom: 10px; }
        h2 { color: #764ba2; margin-top: 30px; }
        .code-block { background: #f8f9fa; border-left: 4px solid #667eea; padding: 15px; margin: 15px 0; font-family: 'Courier New', monospace; overflow-x: auto; white-space: pre-wrap; }
        .note { background: #d1ecf1; border-left: 4px solid #0c5460; padding: 15px; margin: 15px 0; }
        .back-link { display: inline-block; margin-bottom: 20px; color: #667eea; text-decoration: none; }
        .back-link:hover { text-decoration: underline; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #667eea; color: white; }
        tr:nth-child(even) { background: #f8f9fa; }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Home</a>

        <h1>Why Keep-Alive Improves Performance</h1>

        <p>Keep-alive (persistent connections) dramatically improves performance by eliminating connection overhead. Let's quantify the benefits.</p>

        <h2>Performance Metrics</h2>

        <table>
            <tr>
                <th>Metric</th>
                <th>Without Keep-Alive</th>
                <th>With Keep-Alive</th>
                <th>Improvement</th>
            </tr>
            <tr>
                <td><strong>TCP Handshakes</strong></td>
                <td>1 per request</td>
                <td>1 per connection</td>
                <td>~100x fewer</td>
            </tr>
            <tr>
                <td><strong>Latency per Request</strong></td>
                <td>RTT + request time</td>
                <td>Request time only</td>
                <td>~30-50ms saved</td>
            </tr>
            <tr>
                <td><strong>Ports Used (100k requests)</strong></td>
                <td>100,000</td>
                <td>~1,000</td>
                <td>100x reduction</td>
            </tr>
            <tr>
                <td><strong>Server CPU</strong></td>
                <td>High (many connections)</td>
                <td>Low (few connections)</td>
                <td>Significant savings</td>
            </tr>
        </table>

        <h2>Real Benchmark Example</h2>

        <div class="code-block"># Without keep-alive (server default)
java lts.java 8080
java ltc.java -c 100000 -r 1

Result:
  Total: 100,000 requests
  Failed: ~85,000 (port exhaustion!)
  Duration: Unable to complete

# With keep-alive
java lts.java -k 30 8080
java ltc.java -c 1000 -r 100

Result:
  Total: 100,000 requests
  Successful: 100,000
  Duration: ~15 seconds
  RPS: ~6,666 requests/second</div>

        <h2>Latency Savings</h2>

        <p>Each TCP handshake costs 1.5 RTTs. With 20ms RTT:</p>

        <ul>
            <li><strong>Without keep-alive:</strong> 30ms overhead per request</li>
            <li><strong>With keep-alive:</strong> 0ms overhead (after first request)</li>
            <li><strong>For 100 requests:</strong> Save 2,970ms (~3 seconds)</li>
        </ul>

        <h2>Testing on Your Server</h2>

        <div class="code-block"># Test without keep-alive
java lts.java 8080
time java ltc.java -c 100 -r 100

# Test with keep-alive
java lts.java -k 30 8080
time java ltc.java -c 100 -r 100

# Compare the duration - keep-alive should be faster!</div>

        <div class="note">
            <strong>üìö Further Reading:</strong>
            <ul style="margin: 10px 0 0 20px;">
                <li><a href="http-keep-alive.html">HTTP Keep-Alive Deep Dive</a></li>
                <li><a href="tcp-lifecycle.html">TCP Connection Lifecycle</a></li>
                <li><a href="load-testing.html">Load Testing Concepts</a></li>
            </ul>
        </div>

        <p style="margin-top: 40px;"><a href="index.html" class="back-link">‚Üê Back to Home</a></p>
    </div>
</body>
</html>
